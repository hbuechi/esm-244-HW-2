---
title: "ESM 244 | Homework 2"
author: "Hanna Buechi"
date: "2/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r data_packages}

library(tidyverse)
library(ggrepel)
library(lubridate)

whales <- read_csv("captive_cetacean.csv")

```

```{r initial_wrangling}

summary(whales) # everything is character/string data

# interesting time data is birth year (single data point) and transfers (could tell a story about individuals but hard to parse)

# something more than a single histogram... histogram with some other elements...


whales$originDate <- as.Date(whales$originDate, "%m/%d/%y")
whales$originYear <- lubridate::year(whales$originDate)

```


```{r explo_plots}

# ggplot(whales, aes(x = originLocation)) +
  # geom_bar(aes(fill = species))

# too many species, filter out some of them

# ggplot(whales, aes(x = originLocation)) +
  # geom_bar(aes(fill = acquisition))

# too many origin locations

ggplot(whales, aes(x = acquisition)) +
  geom_bar()

# most are cetaceans are captured # when did captures happen? x = origin date --> month and year, y = number of animals captured

```


```{r capture_wrangling}

capture <- whales %>% 
  filter(acquisition == "Capture")

capture$originDate <- as.Date(capture$originDate, "%m/%d/%y") # couldn't pipe this, unfortunately
class(capture$originDate)

capture$originYear <- lubridate::year(capture$originDate) # creates a vector which I add to the capture data set

```

```{r capture_plot}



# more than 150 cetaceans were captured in 1972?????????????????? Huge outlier year
# Marine Mammal Protection Act was effective December 21, 1972 -- introduced December 4, 1971
# Who was capturing --> educational, research, navy
# NOAA issues permits for importing marine mammals and collecting them from the wild. No permit needed to transfer between US facilities (except approval from APHIS under Animal Welfare Act).

# Navy: beluga, bottlenose dolphin, common dolphin, Dall's porpoise, false killer whale, orca, Pacific white-sided, Pilot whale, Risso's dolphin, Rough-toothed dolphin

# https://en.wikipedia.org/wiki/United_States_Navy_Marine_Mammal_Program

# check what is going on in 1972

capture72 <- filter(capture, originYear == "72") # 165 animals
summary(capture72$currently)

length(capture$currently == "U.S. Navy")

count(capture, currently == "U.S. Navy")

# data looks fine

# what about all animals taken to Navy?

ggplot(capture, aes(x = originYear)) +
  geom_bar() +
  labs(title="Whales & Dolphins Captured from the Wild", 
       subtitle="On December 21, 1972, The Marine Mammal Protection Act went into effect. It requires a permit\nto capture a cetacean for scientific or display purposes.") +
  xlab("Year") +
  ylab("Cetaceans captured") +
  geom_segment(aes(x = 50, y = 170, xend = 72.5, yend = 170)) +
  geom_segment(aes(x = 73, y = 170, xend = 100, yend = 170)) +
  geom_text(x=60, y=160, label="Before MMPA") +
  geom_text(x=85, y=160, label="After MMPA") +
  geom_text(x=60, y=100, label="165 whales and dolphins\nwere captured in 1972.") +
  theme_classic()

```


```{r navy}

navy <- filter(whales, currently == "U.S. Navy") # 206 animals



```










